{% extends 'base.html.twig' %}

{% block title %}Bestellen{% endblock %}

{% block body %}
<style>
    .customColorBG {
        background-color: #17A2B8;
        transition: 0.3s;
    }

    .customColorBG:hover {
        background-color: #118c9f;
    }

    .customColorText {
        color: #17A2B8;
    }

    .customColorNumber {
        color: #17A2B8;
        transition: 0.3s;
    }

    .customColorNumber:hover {
        color: #118c9f;
    }

    .customColorBorder {
        border-color: #17A2B8;
        transition: 0.3s;
    }

    .customColorBorder:hover {
        border-color: #118c9f;
    }
</style>

    <div class="flex items-center justify-center mt-16 text-xl">
        <div class="w-1/2 text-center space-y-4 text-xl mb-24">
            <p class="font-semibold">Titel: {{ book.shortTitle }}</p>
            <p>Info: {{ book.info }}</p>
            <p>Buchnummer: {{ book.bnr }}</p>
            <p>Preis: {{ book.price }}€</p>
        </div>
        <div class="w-1/2">
            <div>
                <div>
                    <h3 class="font-semibold text-3xl">Klasse wählen:</h3>
                </div>
                <div class="flex mt-4">
                    <div class="w-1/2 space-y-4">
                        <p>Schulklasse</p>
                        <p>Anzahl der Schüler</p>
                        <p>Davon Repetenten</p>
                        <p>Aktuelles Budget</p>
                    </div>
                    <div class="w-1/2 space-y-4 text-center mr-8">
                        <select id="classSelect" class="mx-auto rounded-sm p-0.5">
                            {% for class in classes %}
                                <option value="{{ class.id }}">{{ class.name }}</option>
                            {% endfor %}
                        </select>
                        <p id="studentAmount"></p>
                        <p id="repeaterAmount"></p>
                        <p id="budgetAmount"></p>
                    </div>
                </div>
            </div>

            <div class="mt-20">
                <div>
                    <h3 class="font-semibold text-3xl">Bestelldetails wählen:</h3>
                </div>
                <div class="flex mt-4">
                    <div class="w-1/2 space-y-4">
                        <p>Anzahl der Buchmenge:</p>
                        <p>Kopie für Lehrer:</p>
                        <p>E-Book:</p>
                        <p>E-Book+:</p>
                    </div>
                    <div class="w-1/2 space-y-4 text-center mr-8">
                        <div class="inline-block">
                            <button
                                    class="border customColorBorder customColorNumber rounded-md ml-1 px-2"
                                    onclick="updateBookAmount(-1)"
                            >-</button>
                            <p class="inline-block w-8" id="bookAmount">3</p>
                            <button
                                    class="border customColorBorder customColorNumber rounded-md mr-1 px-1.5"
                                    onclick="updateBookAmount(1)"
                            >+</button>
                        </div>
                        <div>
                            <input type="checkbox" class="h-4 w-4">
                            <label class="text-xs customColorText">J/N</label>
                        </div>
                        <div>

                            <input type="checkbox" disabled class="h-4 w-4"
                                {% if book.ebookplus %}
                                    checked
                                {% endif %}
                            >
                            <label class="text-xs customColorText">J/N</label>
                        </div>
                        <div>
                            <input type="checkbox" disabled class="h-4 w-4"
                                {% if book.ebook %}
                                    checked
                                {% endif %}
                            >
                            <label class="text-xs customColorText">J/N</label>
                        </div>
                    </div>
                </div>
            </div>

            <div class="mt-12 flex justify-center mr-32 mb-8">
                <button
                    class="customColorBG p-4 rounded-md text-white font-semibold tracking-wider"
                >
                    Zur Bestellliste hinzufügen
                </button>
            </div>
        </div>
    </div>


<script>
    function updateBookAmount(amount) {
        let bookAmount = document.getElementById('bookAmount')
        let currentAmount = parseInt(bookAmount.innerText) + amount
        if(currentAmount < 1) {
            currentAmount = 1
        }

        bookAmount.innerText = currentAmount.toString()
    }

    function updateClassData() {
        let classId = document.getElementById('classSelect').value;

        fetch('/get-class-data/' + classId)
            .then(response => response.json())
            .then(data => {
                console.log(data)
                document.getElementById('studentAmount').textContent = data.studentAmount;
                document.getElementById('repeaterAmount').textContent = data.repeaterAmount;
                document.getElementById('budgetAmount').textContent =
                    data.usedBudgetAmount + '€ / ' + data.budgetAmount + '€';
            });
    }

    document.getElementById('classSelect').addEventListener('change', updateClassData);

    window.addEventListener('load', updateClassData);
</script>

{% endblock %}
